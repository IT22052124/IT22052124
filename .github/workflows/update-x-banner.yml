name: Update X Profile Banner 

on:
  schedule:
    - cron: '0 0 * * *'  
  workflow_dispatch:   

jobs:
  update-banner:
    runs-on: ubuntu-latest
    steps:
      - name: Download SVG graph
        run: |
          curl -L "https://github-readme-activity-graph.vercel.app/graph?username=it22052124&theme=high-contrast" -o graph.svg
    
      - name: Install librsvg (for rsvg-convert)
        run: |
          sudo apt-get update
          sudo apt-get install -y librsvg2-bin
          
      - name: Convert SVG to PNG 
        run: |
          rsvg-convert -w 1500 -h 500 -f png graph.svg -o banner.png

      - name: Install Python dependencies
        run: |
          python -m pip install tweepy

      - name: Update X profile banner
        env:
          TWITTER_API_KEY: ${{ secrets.TWITTER_API_KEY }}
          TWITTER_API_SECRET: ${{ secrets.TWITTER_API_SECRET }}
          TWITTER_ACCESS_TOKEN: ${{ secrets.TWITTER_ACCESS_TOKEN }}
          TWITTER_ACCESS_TOKEN_SECRET: ${{ secrets.TWITTER_ACCESS_TOKEN_SECRET }}
        run: |
          python - <<EOF
          import tweepy
          auth = tweepy.OAuth1UserHandler(
              "${{ secrets.TWITTER_API_KEY }}",
              "${{ secrets.TWITTER_API_SECRET }}",
              "${{ secrets.TWITTER_ACCESS_TOKEN }}",
              "${{ secrets.TWITTER_ACCESS_TOKEN_SECRET }}"
          )
          api = tweepy.API(auth)
          api.update_profile_banner("banner.png")
          print("Banner updated successfully!")
          EOF
